---
description: "LocalBot AI Core Stack Enforcement â€“ Next.js 14 App Router, TypeScript, Tailwind, Supabase, OpenAI, Pinecone, Stripe"
globs: ["src/**/*.ts", "src/**/*.tsx", "src/**/*.js", "src/**/*.jsx"]
alwaysApply: true
---
# LOCALBOT AI â€“ CORE ARCHITECTURE

You are an expert TypeScript/Next.js engineer.

## ğŸ¯ TECH STACK â€“ NON-NEGOTIABLE
- **Framework**: Next.js 14+ (App Router ONLY â€“ NO Pages Router)
- **Language**: TypeScript â€“ EVERY file must be `.tsx` or `.ts`. **NEVER** create `.js` or `.jsx` files.
- **Styling**: Tailwind CSS ONLY â€“ NO CSS modules, NO styled-components, NO inline styles except dynamic values.
- **UI Components**: shadcn/ui + Radix UI primitives. Always extend these, never rebuild from scratch.
- **Database**: Supabase (PostgreSQL) â€“ ALL queries via Supabase client, NO raw SQL in API routes.
- **Auth**: Supabase Auth â€“ NO custom auth, NO NextAuth.js.
- **Payments**: Stripe â€“ webhooks + checkout sessions.
- **Vector DB**: Pinecone â€“ for Q&A embeddings.
- **AI**: OpenAI GPT-4o-mini + text-embedding-3-small.
- **Crawling**: Firecrawl API only.
- **Email**: Resend only.

## ğŸ—ï¸ FOLDER STRUCTURE â€“ MUST FOLLOW
src/
â”œâ”€â”€ app/ # Next.js App Router
â”‚ â”œâ”€â”€ (marketing)/ # Public marketing pages (landing, pricing, blog)
â”‚ â”œâ”€â”€ (auth)/ # Login, signup, password reset
â”‚ â”œâ”€â”€ (dashboard)/ # Authenticated app (onboarding, dashboard, settings)
â”‚ â”œâ”€â”€ api/ # API routes (chat, embeddings, crawl, webhooks)
â”‚ â””â”€â”€ auth/callback/ # Supabase auth callback
â”œâ”€â”€ components/ # React components
â”‚ â”œâ”€â”€ ui/ # shadcn/ui components (autogenerated)
â”‚ â”œâ”€â”€ dashboard/ # Dashboard-specific components
â”‚ â”œâ”€â”€ widget/ # Chat widget components (admin preview)
â”‚ â””â”€â”€ marketing/ # Landing page components
â”œâ”€â”€ lib/ # Core utilities
â”‚ â”œâ”€â”€ supabase/ # Supabase client (browser + server)
â”‚ â”œâ”€â”€ openai/ # OpenAI API clients
â”‚ â”œâ”€â”€ stripe/ # Stripe utilities
â”‚ â”œâ”€â”€ pinecone/ # Vector DB client
â”‚ â””â”€â”€ utils/ # Helper functions
â”œâ”€â”€ hooks/ # Custom React hooks
â”œâ”€â”€ types/ # Global TypeScript types
â””â”€â”€ middleware.ts # Auth middleware

text


## ğŸš« FORBIDDEN PATTERNS
- âŒ **NO** `any` type. Use `unknown` + type guards.
- âŒ **NO** `// ... existing code` placeholders. **EVER.**
- âŒ **NO** `TODO`, `FIXME`, or incomplete implementations.
- âŒ **NO** JavaScript files â€“ TypeScript only.
- âŒ **NO** Pages Router â€“ App Router only.
- âŒ **NO** raw `fetch` in components â€“ use server actions or API routes.
- âŒ **NO** `console.log` in production code â€“ use `console.error` for errors only.

## âœ… REQUIRED PATTERNS
- âœ… **EVERY** exported function must have explicit return type annotation.
- âœ… **EVERY** API route must validate authentication + ownership before mutation.
- âœ… **EVERY** form must use `react-hook-form` + `zod` validation.
- âœ… **ALL** async operations must have loading states and error boundaries.
- âœ… **ALL** database queries must use Supabase RLS policies â€“ verify row-level security.

## ğŸ“‹ PROJECT-SPECIFIC ENFORCEMENT
- This is **LocalBot AI** â€“ an AI chatbot builder for local businesses.
- **Customers**: Business owners who need no-code AI support.
- **UX**: Dead simple, zero friction, mobile-first.
- **Monetization**: Freemium â€“ free tier with limits, paid subscriptions via Stripe.

**IF YOU ARE UNCLEAR ABOUT ARCHITECTURE DECISIONS, ASK BEFORE CODING.**
